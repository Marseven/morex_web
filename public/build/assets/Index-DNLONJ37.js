import{o as r,c as o,d as e,a as i,b as l,h as P,w,l as F,k as _,t as n,i as x,F as k,r as A,n as M,m as p,H as R,L as Z,e as I,I as h,E as S,p as N}from"./app-CheDFxkZ.js";import{b as J,_ as E}from"./AppLayout-6RU6_C7i.js";import{r as O,a as D}from"./ClockIcon-BJS6cWIw.js";import{r as T}from"./BanknotesIcon-BBGD7xnF.js";import{r as q}from"./CalculatorIcon-Q8309DPQ.js";function W(m,g){return r(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function V(m,g){return r(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function G(m,g){return r(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})])}const K={class:"space-y-6"},Q={class:"flex items-center justify-between"},U={class:"flex items-center gap-2"},X={class:"bg-theme-card border border-theme-border rounded-lg p-4"},Y={class:"flex items-center justify-between"},ee={class:"flex items-center gap-3"},te={class:"text-sm font-medium text-theme-text-primary"},se={key:0,class:"flex items-center gap-2 text-success"},re=["disabled"],oe={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},de={class:"bg-theme-card border border-theme-border rounded-lg p-4"},ne={class:"flex items-center gap-2 mb-2"},ie={class:"text-xl font-semibold text-theme-text-primary"},le={class:"bg-theme-card border border-theme-border rounded-lg p-4"},ae={class:"flex items-center gap-2 mb-2"},me={class:"text-xl font-semibold text-theme-text-primary"},xe={class:"bg-theme-card border border-theme-border rounded-lg p-4"},ce={class:"flex items-center gap-2 mb-2"},ue={class:"bg-theme-card border border-theme-border rounded-lg p-4"},pe={class:"flex items-center gap-2 mb-2"},he={class:"bg-theme-card border border-theme-border rounded-lg"},ge={key:0,class:"px-4 py-8 text-center"},be={key:1,class:"w-full"},ve={class:"divide-y divide-theme-border"},fe={class:"px-4 py-3"},ye={class:"flex items-center gap-3"},_e={class:"text-sm text-theme-text-primary"},we={key:0,class:"text-xs text-theme-text-muted"},ke={class:"px-4 py-3 hidden sm:table-cell"},Ce={key:0,class:"text-sm text-theme-text-primary"},Fe={key:1,class:"text-sm text-theme-text-muted"},Ae={class:"px-4 py-3 hidden md:table-cell"},Me={key:0,class:"space-y-1"},Be={class:"flex items-center justify-between text-xs"},$e={class:"text-theme-text-secondary"},je={class:"w-40 h-1.5 bg-theme-surface rounded-full overflow-hidden"},Se={key:1,class:"text-sm text-theme-text-muted"},Ne={class:"px-4 py-3 text-right"},De={class:"flex items-center justify-end gap-2"},Ve=["onClick"],ze={class:"bg-theme-card border border-theme-border rounded-lg"},He={key:0,class:"px-4 py-8 text-center"},Le={key:1,class:"w-full"},Pe={class:"divide-y divide-theme-border"},Re={class:"px-4 py-3"},Ze={class:"flex items-center gap-3"},Ie={class:"text-sm text-theme-text-primary"},Je={key:0,class:"text-xs text-theme-text-muted"},Ee={class:"px-4 py-3 text-right"},Oe={class:"flex items-center justify-end gap-2"},Te=["onClick"],qe={key:0},We={class:"bg-theme-card border border-theme-border rounded-lg divide-y divide-theme-border"},Ge={class:"flex items-center gap-3"},Ke={class:"text-sm font-medium text-theme-text-primary"},Qe={class:"text-xs text-theme-text-muted"},Ue={class:"text-right"},Xe={class:"text-xs text-theme-text-muted"},Ye={class:"bg-theme-card border border-theme-border rounded-xl max-w-md w-full p-6 space-y-4"},et={class:"flex items-center gap-3"},tt={class:"w-10 h-10 rounded-full bg-warning/20 flex items-center justify-center"},st={class:"text-sm text-theme-text-secondary"},rt={class:"space-y-3"},ot={class:"bg-theme-surface rounded-lg p-3 space-y-2"},dt={class:"flex justify-between text-sm"},nt={class:"text-theme-text-primary font-medium"},it={class:"flex justify-between text-sm"},lt={class:"text-theme-text-primary font-medium"},at={class:"border-t border-theme-border pt-2 flex justify-between text-sm"},mt={class:"flex gap-3 pt-2"},xt=["disabled"],ct={key:0,class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},vt={__name:"Index",props:{categories:{type:Array,default:()=>[]},currentMonthClosed:{type:Boolean,default:!1},closures:{type:Array,default:()=>[]},currentMonth:{type:Object,default:()=>({})}},setup(m){const g=m,b=S(!1),v=S(!1),z=()=>{b.value=!0,N.post("/budgets/close-month",{},{onFinish:()=>{b.value=!1,v.value=!1}})},H=(d,t)=>["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"][d-1]+" "+t,a=d=>new Intl.NumberFormat("fr-FR").format(d||0),f=h(()=>g.categories.filter(d=>d.type==="expense")),B=h(()=>g.categories.filter(d=>d.type==="income")),$=d=>{if(d.is_system){alert("Les catégories système ne peuvent pas être supprimées.");return}confirm("Supprimer cette catégorie ?")&&N.delete(`/budgets/${d.id}`)},y=d=>!d.budget_limit||d.budget_limit===0?0:Math.min(100,(d.spent_this_month||0)/d.budget_limit*100),c=h(()=>f.value.reduce((d,t)=>d+(t.budget_limit||0),0)),u=h(()=>f.value.reduce((d,t)=>d+(t.spent_this_month||0),0)),j=h(()=>f.value.filter(d=>d.budget_limit>0)),C=h(()=>j.value.filter(d=>(d.spent_this_month||0)>d.budget_limit).length);return(d,t)=>(r(),o(k,null,[i(l(P),{title:"Budgets & Catégories"}),i(E,null,{default:w(()=>[e("div",K,[e("div",Q,[e("div",U,[i(l(J),{class:"w-5 h-5 text-theme-text-secondary"}),t[3]||(t[3]=e("h1",{class:"text-lg font-semibold text-theme-text-primary"},"Budgets & Catégories",-1))]),i(l(F),{href:"/budgets/create",class:"px-3 py-1.5 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors"},{default:w(()=>[...t[4]||(t[4]=[_(" + Nouvelle catégorie ",-1)])]),_:1})]),e("div",X,[e("div",Y,[e("div",ee,[i(l(O),{class:"w-5 h-5 text-theme-text-secondary"}),e("div",null,[e("p",te,n(m.currentMonth.name),1),t[5]||(t[5]=e("p",{class:"text-xs text-theme-text-muted"},"Période budgétaire en cours",-1))])]),m.currentMonthClosed?(r(),o("div",se,[i(l(D),{class:"w-5 h-5"}),t[6]||(t[6]=e("span",{class:"text-sm font-medium"},"Clôturé",-1))])):(r(),o("button",{key:1,onClick:t[0]||(t[0]=s=>v.value=!0),disabled:j.value.length===0,class:"px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[i(l(G),{class:"w-4 h-4"}),t[7]||(t[7]=_(" Clôturer le mois ",-1))],8,re))])]),e("div",oe,[e("div",de,[e("div",ne,[i(l(T),{class:"w-4 h-4 text-theme-text-secondary"}),t[8]||(t[8]=e("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Budget total",-1))]),e("p",ie,n(a(c.value)),1),t[9]||(t[9]=e("p",{class:"text-xs text-theme-text-muted"},"FCFA / mois",-1))]),e("div",le,[e("div",ae,[i(l(W),{class:"w-4 h-4 text-theme-text-secondary"}),t[10]||(t[10]=e("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Dépensé ce mois",-1))]),e("p",me,n(a(u.value)),1),t[11]||(t[11]=e("p",{class:"text-xs text-theme-text-muted"},"FCFA",-1))]),e("div",xe,[e("div",ce,[i(l(q),{class:x(["w-4 h-4",c.value-u.value>=0?"text-success":"text-danger"])},null,8,["class"]),t[12]||(t[12]=e("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Restant",-1))]),e("p",{class:x(["text-xl font-semibold",c.value-u.value>=0?"text-success":"text-danger"])},n(a(c.value-u.value)),3),t[13]||(t[13]=e("p",{class:"text-xs text-theme-text-muted"},"FCFA",-1))]),e("div",ue,[e("div",pe,[i(l(V),{class:x(["w-4 h-4",C.value>0?"text-danger":"text-success"])},null,8,["class"]),t[14]||(t[14]=e("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Dépassements",-1))]),e("p",{class:x(["text-xl font-semibold",C.value>0?"text-danger":"text-success"])},n(C.value),3),t[15]||(t[15]=e("p",{class:"text-xs text-theme-text-muted"},"catégorie(s)",-1))])]),e("div",null,[t[19]||(t[19]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"Dépenses",-1)),e("div",he,[f.value.length===0?(r(),o("div",ge,[...t[16]||(t[16]=[e("p",{class:"text-sm text-theme-text-secondary"},"Aucune catégorie de dépense",-1)])])):(r(),o("table",be,[t[18]||(t[18]=e("thead",null,[e("tr",{class:"border-b border-theme-border"},[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Catégorie"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider hidden sm:table-cell"},"Budget"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider hidden md:table-cell"},"Progression"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ve,[(r(!0),o(k,null,A(f.value,s=>(r(),o("tr",{key:s.id,class:"hover:bg-theme-surface transition-colors"},[e("td",fe,[e("div",ye,[e("div",{class:"w-2 h-2 rounded-full",style:M({backgroundColor:s.color||"#71717A"})},null,4),e("div",null,[e("p",_e,n(s.name),1),s.is_system?(r(),o("p",we,"Système")):p("",!0)])])]),e("td",ke,[s.budget_limit?(r(),o("span",Ce,n(a(s.budget_limit))+" FCFA",1)):(r(),o("span",Fe,"—"))]),e("td",Ae,[s.budget_limit?(r(),o("div",Me,[e("div",Be,[e("span",$e,n(a(s.spent_this_month))+" / "+n(a(s.budget_limit)),1),e("span",{class:x(y(s)>100?"text-danger":"text-theme-text-muted")},n(Math.round(y(s)))+"% ",3)]),e("div",je,[e("div",{class:x(["h-full rounded-full transition-all",y(s)>100?"bg-danger":y(s)>80?"bg-warning":"bg-theme-btn-primary-bg"]),style:M({width:`${Math.min(100,y(s))}%`})},null,6)])])):(r(),o("span",Se,"Pas de budget"))]),e("td",Ne,[e("div",De,[i(l(F),{href:`/budgets/${s.id}/edit`,class:"text-xs text-theme-text-secondary hover:text-theme-text-primary"},{default:w(()=>[...t[17]||(t[17]=[_(" Modifier ",-1)])]),_:1},8,["href"]),s.is_system?p("",!0):(r(),o("button",{key:0,onClick:L=>$(s),class:"text-xs text-theme-text-secondary hover:text-danger"}," Supprimer ",8,Ve))])])]))),128))])]))])]),e("div",null,[t[23]||(t[23]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"Revenus",-1)),e("div",ze,[B.value.length===0?(r(),o("div",He,[...t[20]||(t[20]=[e("p",{class:"text-sm text-theme-text-secondary"},"Aucune catégorie de revenu",-1)])])):(r(),o("table",Le,[t[22]||(t[22]=e("thead",null,[e("tr",{class:"border-b border-theme-border"},[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Catégorie"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Pe,[(r(!0),o(k,null,A(B.value,s=>(r(),o("tr",{key:s.id,class:"hover:bg-theme-surface transition-colors"},[e("td",Re,[e("div",Ze,[e("div",{class:"w-2 h-2 rounded-full",style:M({backgroundColor:s.color||"#71717A"})},null,4),e("div",null,[e("p",Ie,n(s.name),1),s.is_system?(r(),o("p",Je,"Système")):p("",!0)])])]),e("td",Ee,[e("div",Oe,[i(l(F),{href:`/budgets/${s.id}/edit`,class:"text-xs text-theme-text-secondary hover:text-theme-text-primary"},{default:w(()=>[...t[21]||(t[21]=[_(" Modifier ",-1)])]),_:1},8,["href"]),s.is_system?p("",!0):(r(),o("button",{key:0,onClick:L=>$(s),class:"text-xs text-theme-text-secondary hover:text-danger"}," Supprimer ",8,Te))])])]))),128))])]))])]),m.closures.length>0?(r(),o("div",qe,[t[24]||(t[24]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"Historique des clôtures",-1)),e("div",We,[(r(!0),o(k,null,A(m.closures,s=>(r(),o("div",{key:s.id,class:"px-4 py-3 flex items-center justify-between"},[e("div",Ge,[i(l(D),{class:x(["w-4 h-4",s.total_saved>=0?"text-success":"text-danger"])},null,8,["class"]),e("div",null,[e("p",Ke,n(H(s.month,s.year)),1),e("p",Qe," Revenus: "+n(a(s.total_budget))+" FCFA · Dépenses: "+n(a(s.total_spent))+" FCFA ",1)])]),e("div",Ue,[e("p",{class:x(["text-sm font-semibold",s.total_saved>=0?"text-success":"text-danger"])},n(s.total_saved>=0?"+":"")+n(a(s.total_saved))+" FCFA ",3),e("p",Xe,n(s.total_saved>=0?"excédent":"déficit"),1)])]))),128))])])):p("",!0)]),(r(),R(Z,{to:"body"},[v.value?(r(),o("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t[2]||(t[2]=I(s=>v.value=!1,["self"]))},[e("div",Ye,[e("div",et,[e("div",tt,[i(l(V),{class:"w-5 h-5 text-warning"})]),e("div",null,[t[25]||(t[25]=e("h3",{class:"text-lg font-semibold text-theme-text-primary"},"Clôturer le mois",-1)),e("p",st,n(m.currentMonth.name),1)])]),e("div",rt,[t[29]||(t[29]=e("p",{class:"text-sm text-theme-text-secondary"},' Cette action va calculer vos économies du mois et les transférer vers le compte "Budget économisé". ',-1)),e("div",ot,[e("div",dt,[t[26]||(t[26]=e("span",{class:"text-theme-text-secondary"},"Budget total",-1)),e("span",nt,n(a(c.value))+" FCFA",1)]),e("div",it,[t[27]||(t[27]=e("span",{class:"text-theme-text-secondary"},"Dépensé",-1)),e("span",lt,n(a(u.value))+" FCFA",1)]),e("div",at,[t[28]||(t[28]=e("span",{class:"text-theme-text-secondary font-medium"},"Économies",-1)),e("span",{class:x(["font-semibold",c.value-u.value>=0?"text-success":"text-danger"])},n(a(Math.max(0,c.value-u.value)))+" FCFA ",3)])]),t[30]||(t[30]=e("p",{class:"text-xs text-theme-text-muted"}," Cette action est irréversible pour ce mois. ",-1))]),e("div",mt,[e("button",{onClick:t[1]||(t[1]=s=>v.value=!1),class:"flex-1 px-4 py-2 border border-theme-border text-theme-text-primary text-sm font-medium rounded-md hover:bg-theme-surface transition-colors"}," Annuler "),e("button",{onClick:z,disabled:b.value,class:"flex-1 px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors disabled:opacity-50 flex items-center justify-center gap-2"},[b.value?(r(),o("svg",ct,[...t[31]||(t[31]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):p("",!0),_(" "+n(b.value?"Clôture...":"Confirmer"),1)],8,xt)])])])):p("",!0)]))]),_:1})],64))}};export{vt as default};
