import{o,c as d,d as e,a as l,b as r,h as L,w as _,l as C,k as v,t as i,i as x,F as w,r as F,n as A,m as p,H as P,L as Z,e as J,E as j,p as S}from"./app-C0xRNuCB.js";import{b as R,_ as E}from"./AppLayout-Dim-hrxc.js";import{r as I,a as N}from"./ClockIcon-BIiUcoEF.js";import{r as O}from"./BanknotesIcon-CT4RCrrZ.js";import{r as T}from"./CalculatorIcon-Ci-3tlHW.js";function q(m,h){return o(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function D(m,h){return o(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function W(m,h){return o(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})])}const G={class:"space-y-6"},K={class:"flex items-center justify-between"},Q={class:"flex items-center gap-2"},U={class:"bg-theme-card border border-theme-border rounded-lg p-4"},X={class:"flex items-center justify-between"},Y={class:"flex items-center gap-3"},ee={class:"text-sm font-medium text-theme-text-primary"},te={key:0,class:"flex items-center gap-2 text-success"},se=["disabled"],re={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},oe={class:"bg-theme-card border border-theme-border rounded-lg p-4"},de={class:"flex items-center gap-2 mb-2"},ne={class:"text-xl font-semibold text-theme-text-primary"},ie={class:"bg-theme-card border border-theme-border rounded-lg p-4"},le={class:"flex items-center gap-2 mb-2"},ae={class:"text-xl font-semibold text-theme-text-primary"},me={class:"bg-theme-card border border-theme-border rounded-lg p-4"},xe={class:"flex items-center gap-2 mb-2"},ce={class:"bg-theme-card border border-theme-border rounded-lg p-4"},ue={class:"flex items-center gap-2 mb-2"},pe={class:"bg-theme-card border border-theme-border rounded-lg"},he={key:0,class:"px-4 py-8 text-center"},ge={key:1,class:"w-full"},be={class:"divide-y divide-theme-border"},fe={class:"px-4 py-3"},ye={class:"flex items-center gap-3"},ve={class:"text-sm text-theme-text-primary"},_e={key:0,class:"text-xs text-theme-text-muted"},we={class:"px-4 py-3 hidden sm:table-cell"},ke={key:0,class:"text-sm text-theme-text-primary"},Ce={key:1,class:"text-sm text-theme-text-muted"},Fe={class:"px-4 py-3 hidden md:table-cell"},Ae={key:0,class:"space-y-1"},Me={class:"flex items-center justify-between text-xs"},Be={class:"text-theme-text-secondary"},$e={class:"w-40 h-1.5 bg-theme-surface rounded-full overflow-hidden"},je={key:1,class:"text-sm text-theme-text-muted"},Se={class:"px-4 py-3 text-right"},Ne={class:"flex items-center justify-end gap-2"},De=["onClick"],Ve={class:"bg-theme-card border border-theme-border rounded-lg"},ze={key:0,class:"px-4 py-8 text-center"},He={key:1,class:"w-full"},Le={class:"divide-y divide-theme-border"},Pe={class:"px-4 py-3"},Ze={class:"flex items-center gap-3"},Je={class:"text-sm text-theme-text-primary"},Re={key:0,class:"text-xs text-theme-text-muted"},Ee={class:"px-4 py-3 text-right"},Ie={class:"flex items-center justify-end gap-2"},Oe=["onClick"],Te={key:0},qe={class:"bg-theme-card border border-theme-border rounded-lg divide-y divide-theme-border"},We={class:"flex items-center gap-3"},Ge={class:"text-sm font-medium text-theme-text-primary"},Ke={class:"text-xs text-theme-text-muted"},Qe={class:"text-right"},Ue={class:"bg-theme-card border border-theme-border rounded-xl max-w-md w-full p-6 space-y-4"},Xe={class:"flex items-center gap-3"},Ye={class:"w-10 h-10 rounded-full bg-warning/20 flex items-center justify-center"},et={class:"text-sm text-theme-text-secondary"},tt={class:"space-y-3"},st={class:"bg-theme-surface rounded-lg p-3 space-y-2"},rt={class:"flex justify-between text-sm"},ot={class:"text-theme-text-primary font-medium"},dt={class:"flex justify-between text-sm"},nt={class:"text-theme-text-primary font-medium"},it={class:"border-t border-theme-border pt-2 flex justify-between text-sm"},lt={class:"flex gap-3 pt-2"},at=["disabled"],mt={key:0,class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},gt={__name:"Index",props:{categories:{type:Array,default:()=>[]},currentMonthClosed:{type:Boolean,default:!1},closures:{type:Array,default:()=>[]},currentMonth:{type:Object,default:()=>({})}},setup(m){const h=m,g=j(!1),b=j(!1),V=()=>{g.value=!0,S.post("/budgets/close-month",{},{onFinish:()=>{g.value=!1,b.value=!1}})},z=(n,t)=>["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"][n-1]+" "+t,a=n=>new Intl.NumberFormat("fr-FR").format(n||0),f=h.categories.filter(n=>n.type==="expense"),M=h.categories.filter(n=>n.type==="income"),B=n=>{if(n.is_system){alert("Les catégories système ne peuvent pas être supprimées.");return}confirm("Supprimer cette catégorie ?")&&S.delete(`/budgets/${n.id}`)},y=n=>!n.budget_limit||n.budget_limit===0?0:Math.min(100,(n.spent_this_month||0)/n.budget_limit*100),c=f.reduce((n,t)=>n+(t.budget_limit||0),0),u=f.reduce((n,t)=>n+(t.spent_this_month||0),0),$=f.filter(n=>n.budget_limit>0),k=$.filter(n=>(n.spent_this_month||0)>n.budget_limit).length;return(n,t)=>(o(),d(w,null,[l(r(L),{title:"Budgets & Catégories"}),l(E,null,{default:_(()=>[e("div",G,[e("div",K,[e("div",Q,[l(r(R),{class:"w-5 h-5 text-theme-text-secondary"}),t[3]||(t[3]=e("h1",{class:"text-lg font-semibold text-theme-text-primary"},"Budgets & Catégories",-1))]),l(r(C),{href:"/budgets/create",class:"px-3 py-1.5 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors"},{default:_(()=>[...t[4]||(t[4]=[v(" + Nouvelle catégorie ",-1)])]),_:1})]),e("div",U,[e("div",X,[e("div",Y,[l(r(I),{class:"w-5 h-5 text-theme-text-secondary"}),e("div",null,[e("p",ee,i(m.currentMonth.name),1),t[5]||(t[5]=e("p",{class:"text-xs text-theme-text-muted"},"Période budgétaire en cours",-1))])]),m.currentMonthClosed?(o(),d("div",te,[l(r(N),{class:"w-5 h-5"}),t[6]||(t[6]=e("span",{class:"text-sm font-medium"},"Clôturé",-1))])):(o(),d("button",{key:1,onClick:t[0]||(t[0]=s=>b.value=!0),disabled:r($).length===0,class:"px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[l(r(W),{class:"w-4 h-4"}),t[7]||(t[7]=v(" Clôturer le mois ",-1))],8,se))])]),e("div",re,[e("div",oe,[e("div",de,[l(r(O),{class:"w-4 h-4 text-theme-text-secondary"}),t[8]||(t[8]=e("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Budget total",-1))]),e("p",ne,i(a(r(c))),1),t[9]||(t[9]=e("p",{class:"text-xs text-theme-text-muted"},"FCFA / mois",-1))]),e("div",ie,[e("div",le,[l(r(q),{class:"w-4 h-4 text-theme-text-secondary"}),t[10]||(t[10]=e("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Dépensé ce mois",-1))]),e("p",ae,i(a(r(u))),1),t[11]||(t[11]=e("p",{class:"text-xs text-theme-text-muted"},"FCFA",-1))]),e("div",me,[e("div",xe,[l(r(T),{class:x(["w-4 h-4",r(c)-r(u)>=0?"text-success":"text-danger"])},null,8,["class"]),t[12]||(t[12]=e("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Restant",-1))]),e("p",{class:x(["text-xl font-semibold",r(c)-r(u)>=0?"text-success":"text-danger"])},i(a(r(c)-r(u))),3),t[13]||(t[13]=e("p",{class:"text-xs text-theme-text-muted"},"FCFA",-1))]),e("div",ce,[e("div",ue,[l(r(D),{class:x(["w-4 h-4",r(k)>0?"text-danger":"text-success"])},null,8,["class"]),t[14]||(t[14]=e("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Dépassements",-1))]),e("p",{class:x(["text-xl font-semibold",r(k)>0?"text-danger":"text-success"])},i(r(k)),3),t[15]||(t[15]=e("p",{class:"text-xs text-theme-text-muted"},"catégorie(s)",-1))])]),e("div",null,[t[19]||(t[19]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"Dépenses",-1)),e("div",pe,[r(f).length===0?(o(),d("div",he,[...t[16]||(t[16]=[e("p",{class:"text-sm text-theme-text-secondary"},"Aucune catégorie de dépense",-1)])])):(o(),d("table",ge,[t[18]||(t[18]=e("thead",null,[e("tr",{class:"border-b border-theme-border"},[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Catégorie"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider hidden sm:table-cell"},"Budget"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider hidden md:table-cell"},"Progression"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Actions")])],-1)),e("tbody",be,[(o(!0),d(w,null,F(r(f),s=>(o(),d("tr",{key:s.id,class:"hover:bg-theme-surface transition-colors"},[e("td",fe,[e("div",ye,[e("div",{class:"w-2 h-2 rounded-full",style:A({backgroundColor:s.color||"#71717A"})},null,4),e("div",null,[e("p",ve,i(s.name),1),s.is_system?(o(),d("p",_e,"Système")):p("",!0)])])]),e("td",we,[s.budget_limit?(o(),d("span",ke,i(a(s.budget_limit))+" FCFA",1)):(o(),d("span",Ce,"—"))]),e("td",Fe,[s.budget_limit?(o(),d("div",Ae,[e("div",Me,[e("span",Be,i(a(s.spent_this_month))+" / "+i(a(s.budget_limit)),1),e("span",{class:x(y(s)>100?"text-danger":"text-theme-text-muted")},i(Math.round(y(s)))+"% ",3)]),e("div",$e,[e("div",{class:x(["h-full rounded-full transition-all",y(s)>100?"bg-danger":y(s)>80?"bg-warning":"bg-theme-btn-primary-bg"]),style:A({width:`${Math.min(100,y(s))}%`})},null,6)])])):(o(),d("span",je,"Pas de budget"))]),e("td",Se,[e("div",Ne,[l(r(C),{href:`/budgets/${s.id}/edit`,class:"text-xs text-theme-text-secondary hover:text-theme-text-primary"},{default:_(()=>[...t[17]||(t[17]=[v(" Modifier ",-1)])]),_:1},8,["href"]),s.is_system?p("",!0):(o(),d("button",{key:0,onClick:H=>B(s),class:"text-xs text-theme-text-secondary hover:text-danger"}," Supprimer ",8,De))])])]))),128))])]))])]),e("div",null,[t[23]||(t[23]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"Revenus",-1)),e("div",Ve,[r(M).length===0?(o(),d("div",ze,[...t[20]||(t[20]=[e("p",{class:"text-sm text-theme-text-secondary"},"Aucune catégorie de revenu",-1)])])):(o(),d("table",He,[t[22]||(t[22]=e("thead",null,[e("tr",{class:"border-b border-theme-border"},[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Catégorie"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Le,[(o(!0),d(w,null,F(r(M),s=>(o(),d("tr",{key:s.id,class:"hover:bg-theme-surface transition-colors"},[e("td",Pe,[e("div",Ze,[e("div",{class:"w-2 h-2 rounded-full",style:A({backgroundColor:s.color||"#71717A"})},null,4),e("div",null,[e("p",Je,i(s.name),1),s.is_system?(o(),d("p",Re,"Système")):p("",!0)])])]),e("td",Ee,[e("div",Ie,[l(r(C),{href:`/budgets/${s.id}/edit`,class:"text-xs text-theme-text-secondary hover:text-theme-text-primary"},{default:_(()=>[...t[21]||(t[21]=[v(" Modifier ",-1)])]),_:1},8,["href"]),s.is_system?p("",!0):(o(),d("button",{key:0,onClick:H=>B(s),class:"text-xs text-theme-text-secondary hover:text-danger"}," Supprimer ",8,Oe))])])]))),128))])]))])]),m.closures.length>0?(o(),d("div",Te,[t[25]||(t[25]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"Historique des clôtures",-1)),e("div",qe,[(o(!0),d(w,null,F(m.closures,s=>(o(),d("div",{key:s.id,class:"px-4 py-3 flex items-center justify-between"},[e("div",We,[l(r(N),{class:"w-4 h-4 text-success"}),e("div",null,[e("p",Ge,i(z(s.month,s.year)),1),e("p",Ke," Budget: "+i(a(s.total_budget))+" FCFA · Dépensé: "+i(a(s.total_spent))+" FCFA ",1)])]),e("div",Qe,[e("p",{class:x(["text-sm font-semibold",s.total_saved>0?"text-success":"text-theme-text-primary"])},i(s.total_saved>0?"+":"")+i(a(s.total_saved))+" FCFA ",3),t[24]||(t[24]=e("p",{class:"text-xs text-theme-text-muted"},"économisé",-1))])]))),128))])])):p("",!0)]),(o(),P(Z,{to:"body"},[b.value?(o(),d("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t[2]||(t[2]=J(s=>b.value=!1,["self"]))},[e("div",Ue,[e("div",Xe,[e("div",Ye,[l(r(D),{class:"w-5 h-5 text-warning"})]),e("div",null,[t[26]||(t[26]=e("h3",{class:"text-lg font-semibold text-theme-text-primary"},"Clôturer le mois",-1)),e("p",et,i(m.currentMonth.name),1)])]),e("div",tt,[t[30]||(t[30]=e("p",{class:"text-sm text-theme-text-secondary"},' Cette action va calculer vos économies du mois et les transférer vers le compte "Budget économisé". ',-1)),e("div",st,[e("div",rt,[t[27]||(t[27]=e("span",{class:"text-theme-text-secondary"},"Budget total",-1)),e("span",ot,i(a(r(c)))+" FCFA",1)]),e("div",dt,[t[28]||(t[28]=e("span",{class:"text-theme-text-secondary"},"Dépensé",-1)),e("span",nt,i(a(r(u)))+" FCFA",1)]),e("div",it,[t[29]||(t[29]=e("span",{class:"text-theme-text-secondary font-medium"},"Économies",-1)),e("span",{class:x(["font-semibold",r(c)-r(u)>=0?"text-success":"text-danger"])},i(a(Math.max(0,r(c)-r(u))))+" FCFA ",3)])]),t[31]||(t[31]=e("p",{class:"text-xs text-theme-text-muted"}," Cette action est irréversible pour ce mois. ",-1))]),e("div",lt,[e("button",{onClick:t[1]||(t[1]=s=>b.value=!1),class:"flex-1 px-4 py-2 border border-theme-border text-theme-text-primary text-sm font-medium rounded-md hover:bg-theme-surface transition-colors"}," Annuler "),e("button",{onClick:V,disabled:g.value,class:"flex-1 px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors disabled:opacity-50 flex items-center justify-center gap-2"},[g.value?(o(),d("svg",mt,[...t[32]||(t[32]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):p("",!0),v(" "+i(g.value?"Clôture...":"Confirmer"),1)],8,at)])])])):p("",!0)]))]),_:1})],64))}};export{gt as default};
