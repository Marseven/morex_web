import{o,c as d,d as e,u as f,a as v,b as r,h as J,w as Q,n as K,t as i,m as l,e as F,f as c,v as p,F as z,r as W,i as D,p as P,E as S,J as X,I as Y}from"./app-BB-1s2nu.js";import{_ as ee}from"./AppLayout-DoW_K_UD.js";function T(u,m){return o(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"})])}function te(u,m){return o(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})])}const re={class:"max-w-2xl mx-auto space-y-6"},se={class:"flex items-center gap-2"},oe={class:"bg-theme-card border border-theme-border rounded-lg p-6"},de={class:"flex items-center gap-6"},ne={class:"relative"},ae={key:1,class:"w-20 h-20 rounded-full bg-theme-surface border-2 border-theme-border flex items-center justify-center"},ie={class:"text-2xl font-semibold text-theme-text-secondary"},le={class:"flex flex-col gap-2"},me={class:"space-y-4"},ue={key:0,class:"text-xs text-danger mt-1"},ce={key:0,class:"text-xs text-danger mt-1"},pe={key:0,class:"text-xs text-danger mt-1"},xe={class:"mt-6 flex justify-end"},be=["disabled"],he={class:"space-y-4"},fe={key:0,class:"text-xs text-danger mt-1"},ye={key:0,class:"text-xs text-danger mt-1"},ge={class:"mt-6 flex justify-end"},ve=["disabled"],we={class:"bg-theme-card border border-theme-border rounded-lg p-6"},ke={class:"flex items-center gap-2 mb-4"},Ce={key:0,class:"mb-4 bg-theme-surface border border-green-500/30 text-green-400 rounded-md px-4 py-3 text-sm"},_e={key:1},Fe=["disabled"],Se={key:2},Ae={class:"flex flex-col items-center gap-4 mb-6"},Me=["innerHTML"],Ue={class:"text-center"},Ve={class:"text-sm text-theme-text-primary bg-theme-surface px-3 py-1 rounded font-mono"},je={key:0,class:"text-xs text-danger mt-1"},qe=["disabled"],Ie={key:3},ze={class:"flex items-center gap-2 text-green-400 mb-4"},De={key:0,class:"mb-6"},Pe={class:"bg-theme-surface border border-theme-border rounded-md p-4 grid grid-cols-2 gap-2"},Te={class:"space-y-4"},Re={class:"flex gap-2"},Be=["disabled"],Ee={key:0,class:"text-xs text-danger mt-1"},Ne={class:"flex gap-2"},$e=["disabled"],Le={key:0,class:"text-xs text-danger mt-1"},Ge={class:"bg-theme-card border border-theme-border rounded-lg p-6"},Oe={class:"flex gap-4"},Je={__name:"Edit",props:{user:{type:Object,required:!0},twoFactor:{type:Object,default:()=>({enabled:!1,qrCodeSvg:null,secret:null,recoveryCodes:null})}},setup(u){const m=u,C=X(),n=f({name:m.user.name,email:m.user.email,phone:m.user.phone||""}),R=()=>{n.put("/profile")},a=f({current_password:"",password:"",password_confirmation:""}),B=()=>{a.put("/profile/password",{onSuccess:()=>{a.reset()}})},A=S(null),w=S(null),E=()=>{A.value.click()},N=k=>{const t=k.target.files[0];if(t){w.value=URL.createObjectURL(t);const g=new FormData;g.append("avatar",t),P.post("/profile/avatar",g,{forceFormData:!0})}},$=()=>{confirm("Supprimer la photo de profil ?")&&(P.delete("/profile/avatar"),w.value=null)},y=f({theme:m.user.theme||"dark"}),M=()=>{y.put("/profile/theme")},U=()=>w.value?w.value:m.user.avatar?`/storage/${m.user.avatar}`:null,L=()=>m.user.name.split(" ").map(k=>k[0]).join("").toUpperCase().slice(0,2),_=S(!1),V=f({}),h=f({code:""}),x=f({password:""}),b=f({password:""}),G=()=>{V.post("/two-factor/enable",{preserveScroll:!0})},O=()=>{h.post("/two-factor/confirm",{preserveScroll:!0,onSuccess:()=>{h.reset(),_.value=!0}})},Z=()=>{confirm("Voulez-vous vraiment désactiver l'authentification à deux facteurs ?")&&x.delete("/two-factor/disable",{preserveScroll:!0,onSuccess:()=>{x.reset(),_.value=!1}})},H=()=>{b.post("/two-factor/recovery-codes",{preserveScroll:!0,onSuccess:()=>{b.reset()}})},j=Y(()=>m.twoFactor.qrCodeSvg&&!m.twoFactor.enabled);return(k,t)=>(o(),d(z,null,[v(r(J),{title:"Profil"}),v(ee,null,{default:Q(()=>{var g,q,I;return[e("div",re,[e("div",se,[v(r(te),{class:"w-5 h-5 text-theme-text-secondary"}),t[11]||(t[11]=e("h1",{class:"text-lg font-semibold text-theme-text-primary"},"Mon profil",-1))]),e("div",oe,[t[12]||(t[12]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-4"},"Photo de profil",-1)),e("div",de,[e("div",ne,[U()?(o(),d("div",{key:0,class:"w-20 h-20 rounded-full bg-cover bg-center border-2 border-theme-border",style:K({backgroundImage:`url(${U()})`})},null,4)):(o(),d("div",ae,[e("span",ie,i(L()),1)]))]),e("div",le,[e("input",{ref_key:"avatarInput",ref:A,type:"file",accept:"image/*",class:"hidden",onChange:N},null,544),e("button",{type:"button",onClick:E,class:"px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors"}," Changer la photo "),u.user.avatar?(o(),d("button",{key:0,type:"button",onClick:$,class:"px-4 py-2 text-sm text-theme-text-secondary hover:text-danger border border-theme-border rounded-md transition-colors"}," Supprimer ")):l("",!0)])]),t[13]||(t[13]=e("p",{class:"text-xs text-theme-text-muted mt-3"},"JPG, PNG ou GIF. Max 2MB.",-1))]),e("form",{onSubmit:F(R,["prevent"]),class:"bg-theme-card border border-theme-border rounded-lg p-6"},[t[17]||(t[17]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-4"},"Informations personnelles",-1)),e("div",me,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-2"},"Nom",-1)),c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r(n).name=s),type:"text",required:"",class:"w-full bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[p,r(n).name]]),r(n).errors.name?(o(),d("p",ue,i(r(n).errors.name),1)):l("",!0)]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-2"},"Email",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>r(n).email=s),type:"email",required:"",class:"w-full bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[p,r(n).email]]),r(n).errors.email?(o(),d("p",ce,i(r(n).errors.email),1)):l("",!0)]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-2"},"Téléphone",-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>r(n).phone=s),type:"tel",class:"w-full bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary placeholder-theme-text-muted focus:border-theme-text-primary focus:ring-0 outline-none",placeholder:"+241 77 12 34 56"},null,512),[[p,r(n).phone]]),r(n).errors.phone?(o(),d("p",pe,i(r(n).errors.phone),1)):l("",!0)])]),e("div",xe,[e("button",{type:"submit",disabled:r(n).processing,class:"px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors disabled:opacity-50"}," Enregistrer ",8,be)])],32),e("form",{onSubmit:F(B,["prevent"]),class:"bg-theme-card border border-theme-border rounded-lg p-6"},[t[21]||(t[21]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-4"},"Mot de passe",-1)),e("div",he,[e("div",null,[t[18]||(t[18]=e("label",{class:"block text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-2"},"Mot de passe actuel",-1)),c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>r(a).current_password=s),type:"password",required:"",class:"w-full bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[p,r(a).current_password]]),r(a).errors.current_password?(o(),d("p",fe,i(r(a).errors.current_password),1)):l("",!0)]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-2"},"Nouveau mot de passe",-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>r(a).password=s),type:"password",required:"",class:"w-full bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[p,r(a).password]]),r(a).errors.password?(o(),d("p",ye,i(r(a).errors.password),1)):l("",!0)]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-2"},"Confirmer le mot de passe",-1)),c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>r(a).password_confirmation=s),type:"password",required:"",class:"w-full bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[p,r(a).password_confirmation]])])]),e("div",ge,[e("button",{type:"submit",disabled:r(a).processing,class:"px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors disabled:opacity-50"}," Changer le mot de passe ",8,ve)])],32),e("div",we,[e("div",ke,[v(r(T),{class:"w-5 h-5 text-theme-text-secondary"}),t[22]||(t[22]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Authentification à deux facteurs",-1))]),(g=r(C).props.flash)!=null&&g.success?(o(),d("div",Ce,i(r(C).props.flash.success),1)):l("",!0),!u.twoFactor.enabled&&!j.value?(o(),d("div",_e,[t[23]||(t[23]=e("p",{class:"text-sm text-theme-text-secondary mb-4"}," Ajoutez une couche de sécurité supplémentaire à votre compte en activant l'authentification à deux facteurs. ",-1)),e("button",{type:"button",onClick:G,disabled:r(V).processing,class:"px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors disabled:opacity-50"}," Activer ",8,Fe)])):j.value?(o(),d("div",Se,[t[26]||(t[26]=e("p",{class:"text-sm text-theme-text-secondary mb-4"}," Scannez le QR code ci-dessous avec votre application d'authentification (Google Authenticator, Authy, etc.) ",-1)),e("div",Ae,[e("div",{class:"bg-white p-4 rounded-lg",innerHTML:u.twoFactor.qrCodeSvg},null,8,Me),e("div",Ue,[t[24]||(t[24]=e("p",{class:"text-xs text-theme-text-muted mb-1"},"Ou entrez ce code manuellement :",-1)),e("code",Ve,i(u.twoFactor.secret),1)])]),e("form",{onSubmit:F(O,["prevent"]),class:"space-y-4"},[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-2"}," Code de vérification ",-1)),c(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>r(h).code=s),type:"text",inputmode:"numeric",maxlength:"6",required:"",class:"w-full bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary text-center tracking-widest font-mono focus:border-theme-text-primary focus:ring-0 outline-none",placeholder:"000000"},null,512),[[p,r(h).code]]),r(h).errors.code?(o(),d("p",je,i(r(h).errors.code),1)):l("",!0)]),e("button",{type:"submit",disabled:r(h).processing,class:"w-full px-4 py-2 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors disabled:opacity-50"}," Confirmer ",8,qe)],32)])):u.twoFactor.enabled?(o(),d("div",Ie,[e("div",ze,[v(r(T),{class:"w-5 h-5"}),t[27]||(t[27]=e("span",{class:"text-sm font-medium"},"Authentification à deux facteurs activée",-1))]),u.twoFactor.recoveryCodes&&(_.value||(I=(q=r(C).props.flash)==null?void 0:q.success)!=null&&I.includes("régénérés"))?(o(),d("div",De,[t[28]||(t[28]=e("p",{class:"text-sm text-theme-text-secondary mb-3"}," Conservez ces codes de récupération dans un endroit sûr. Ils vous permettront de vous connecter si vous perdez l'accès à votre appareil. ",-1)),e("div",Pe,[(o(!0),d(z,null,W(u.twoFactor.recoveryCodes,s=>(o(),d("code",{key:s,class:"text-sm text-theme-text-primary font-mono"},i(s),1))),128))])])):l("",!0),e("div",Te,[e("div",null,[t[29]||(t[29]=e("p",{class:"text-sm text-theme-text-secondary mb-2"},"Régénérer les codes de récupération",-1)),e("div",Re,[c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>r(b).password=s),type:"password",placeholder:"Mot de passe actuel",class:"flex-1 bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[p,r(b).password]]),e("button",{type:"button",onClick:H,disabled:r(b).processing||!r(b).password,class:"px-4 py-2 text-sm text-theme-text-secondary hover:text-theme-text-primary border border-theme-border rounded-md transition-colors disabled:opacity-50"}," Régénérer ",8,Be)]),r(b).errors.password?(o(),d("p",Ee,i(r(b).errors.password),1)):l("",!0)]),e("div",null,[t[30]||(t[30]=e("p",{class:"text-sm text-theme-text-secondary mb-2"},"Désactiver l'authentification à deux facteurs",-1)),e("div",Ne,[c(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>r(x).password=s),type:"password",placeholder:"Mot de passe actuel",class:"flex-1 bg-theme-surface border border-theme-border rounded-md px-3 py-2 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[p,r(x).password]]),e("button",{type:"button",onClick:Z,disabled:r(x).processing||!r(x).password,class:"px-4 py-2 text-sm text-danger hover:bg-danger/10 border border-danger/30 rounded-md transition-colors disabled:opacity-50"}," Désactiver ",8,$e)]),r(x).errors.password?(o(),d("p",Le,i(r(x).errors.password),1)):l("",!0)])])])):l("",!0)]),e("div",Ge,[t[33]||(t[33]=e("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-4"},"Apparence",-1)),e("div",Oe,[e("button",{type:"button",onClick:t[9]||(t[9]=s=>{r(y).theme="dark",M()}),class:D(["flex-1 p-4 rounded-lg border-2 transition-all",r(y).theme==="dark"?"border-theme-btn-primary-bg":"border-theme-border hover:border-theme-text-secondary"])},[...t[31]||(t[31]=[e("div",{class:"w-full h-20 rounded bg-black border border-zinc-800 mb-3 flex items-center justify-center"},[e("div",{class:"w-8 h-1 bg-white rounded"})],-1),e("p",{class:"text-sm font-medium text-theme-text-primary"},"Sombre",-1),e("p",{class:"text-xs text-theme-text-muted"},"Interface sombre",-1)])],2),e("button",{type:"button",onClick:t[10]||(t[10]=s=>{r(y).theme="light",M()}),class:D(["flex-1 p-4 rounded-lg border-2 transition-all",r(y).theme==="light"?"border-theme-btn-primary-bg":"border-theme-border hover:border-theme-text-secondary"])},[...t[32]||(t[32]=[e("div",{class:"w-full h-20 rounded bg-white border border-gray-200 mb-3 flex items-center justify-center"},[e("div",{class:"w-8 h-1 bg-black rounded"})],-1),e("p",{class:"text-sm font-medium text-theme-text-primary"},"Clair",-1),e("p",{class:"text-xs text-theme-text-muted"},"Interface claire",-1)])],2)])])])]}),_:1})],64))}};export{Je as default};
