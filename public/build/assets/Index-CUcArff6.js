import{o as n,c as d,d as t,u as N,a as c,b as i,h as V,w as b,l as v,k as f,t as o,i as y,F as _,r as C,f as F,v as S,m as x,n as B,I as $,p as Z,E as R}from"./app-CheDFxkZ.js";import{e as E,_ as L}from"./AppLayout-6RU6_C7i.js";function I(a,h){return n(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9 12.75 3 3m0 0 3-3m-3 3v-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function O(a,h){return n(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m15 11.25-3-3m0 0-3 3m3-3v7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function T(a,h){return n(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})])}function z(a,h){return n(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0 0 12 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52 2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 0 1-2.031.352 5.988 5.988 0 0 1-2.031-.352c-.483-.174-.711-.703-.59-1.202L18.75 4.971Zm-16.5.52c.99-.203 1.99-.377 3-.52m0 0 2.62 10.726c.122.499-.106 1.028-.589 1.202a5.989 5.989 0 0 1-2.031.352 5.989 5.989 0 0 1-2.031-.352c-.483-.174-.711-.703-.59-1.202L5.25 4.971Z"})])}const H={class:"space-y-6"},J={class:"flex items-center justify-between"},U={class:"flex items-center gap-2"},q={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},G={class:"bg-theme-card border border-theme-border rounded-lg p-4"},K={class:"flex items-center gap-2 mb-2"},Q={class:"text-xl font-semibold text-danger"},W={class:"text-xs text-theme-text-muted"},X={class:"bg-theme-card border border-theme-border rounded-lg p-4"},Y={class:"flex items-center gap-2 mb-2"},tt={class:"text-xl font-semibold text-success"},et={class:"text-xs text-theme-text-muted"},st={class:"bg-theme-card border border-theme-border rounded-lg p-4"},rt={class:"flex items-center gap-2 mb-2"},ot={class:"bg-theme-card border border-theme-border rounded-lg p-4"},nt={class:"flex items-center gap-2 mb-2"},dt={key:0},at={class:"bg-theme-card border border-theme-border rounded-lg divide-y divide-theme-border"},it={class:"flex items-start justify-between mb-3"},lt={class:"text-sm font-medium text-theme-text-primary"},ct={class:"text-xs text-theme-text-muted"},mt={class:"flex items-center gap-2"},ut=["onClick"],xt=["onClick"],ht={key:0,class:"mb-3 flex gap-2"},pt=["onClick","disabled"],bt={class:"flex items-center justify-between text-xs mb-2"},yt={class:"text-theme-text-secondary"},vt={class:"text-danger"},ft={class:"w-full h-2 bg-theme-surface rounded-full overflow-hidden"},_t={key:1,class:"text-xs text-theme-text-muted mt-2"},gt={key:1},kt={class:"bg-theme-card border border-theme-border rounded-lg divide-y divide-theme-border"},wt={class:"flex items-start justify-between mb-3"},Ct={class:"text-sm font-medium text-theme-text-primary"},$t={class:"text-xs text-theme-text-muted"},Mt={class:"flex items-center gap-2"},jt=["onClick"],Dt=["onClick"],At={key:0,class:"mb-3 flex gap-2"},Pt=["onClick","disabled"],Ft={class:"flex items-center justify-between text-xs mb-2"},St={class:"text-theme-text-secondary"},Bt={class:"text-success"},Nt={class:"w-full h-2 bg-theme-surface rounded-full overflow-hidden"},Vt={key:1,class:"text-xs text-theme-text-muted mt-2"},Zt={key:2,class:"bg-theme-card border border-theme-border rounded-lg px-4 py-12 text-center"},Rt={key:3},Et={class:"bg-theme-card border border-theme-border rounded-lg"},Lt={class:"w-full"},It={class:"divide-y divide-theme-border"},Ot={class:"px-4 py-3 text-sm text-theme-text-primary"},Tt={class:"px-4 py-3 text-sm text-right text-theme-text-primary"},zt={class:"px-4 py-3 text-right"},Ht=["onClick"],qt={__name:"Index",props:{debts:{type:Array,default:()=>[]},stats:{type:Object,default:()=>({})}},setup(a){const h=a,m=r=>new Intl.NumberFormat("fr-FR").format(r||0),M=r=>r?new Date(r).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"}):"—",g=$(()=>h.debts.filter(r=>r.status==="active"&&r.type==="debt")),k=$(()=>h.debts.filter(r=>r.status==="active"&&r.type==="credit")),j=$(()=>h.debts.filter(r=>r.status==="paid")),w=r=>{confirm("Supprimer cette entrée ?")&&Z.delete(`/debts/${r.id}`)},p=R(null),u=N({amount:""}),D=r=>{p.value=r.id,u.amount=""},A=r=>{u.post(`/debts/${r.id}/payment`,{onSuccess:()=>{p.value=null}})},P=r=>{if(!r.initial_amount)return 0;const e=r.initial_amount-r.current_amount;return Math.min(100,e/r.initial_amount*100)};return(r,e)=>(n(),d(_,null,[c(i(V),{title:"Dettes & Créances"}),c(L,null,{default:b(()=>[t("div",H,[t("div",J,[t("div",U,[c(i(E),{class:"w-5 h-5 text-theme-text-secondary"}),e[4]||(e[4]=t("h1",{class:"text-lg font-semibold text-theme-text-primary"},"Dettes & Créances",-1))]),c(i(v),{href:"/debts/create",class:"px-3 py-1.5 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 transition-colors"},{default:b(()=>[...e[5]||(e[5]=[f(" + Ajouter ",-1)])]),_:1})]),t("div",q,[t("div",G,[t("div",K,[c(i(I),{class:"w-4 h-4 text-danger"}),e[6]||(e[6]=t("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Je dois",-1))]),t("p",Q,o(m(a.stats.total_debt)),1),t("p",W,o(a.stats.active_debts)+" dette(s)",1)]),t("div",X,[t("div",Y,[c(i(O),{class:"w-4 h-4 text-success"}),e[7]||(e[7]=t("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"On me doit",-1))]),t("p",tt,o(m(a.stats.total_credit)),1),t("p",et,o(a.stats.active_credits)+" créance(s)",1)]),t("div",st,[t("div",rt,[c(i(z),{class:y(["w-4 h-4",a.stats.total_credit-a.stats.total_debt>=0?"text-success":"text-danger"])},null,8,["class"]),e[8]||(e[8]=t("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"Position nette",-1))]),t("p",{class:y(["text-xl font-semibold",a.stats.total_credit-a.stats.total_debt>=0?"text-success":"text-danger"])},o(m(a.stats.total_credit-a.stats.total_debt)),3),e[9]||(e[9]=t("p",{class:"text-xs text-theme-text-muted"},"FCFA",-1))]),t("div",ot,[t("div",nt,[c(i(T),{class:y(["w-4 h-4",a.stats.overdue_count>0?"text-danger":"text-success"])},null,8,["class"]),e[10]||(e[10]=t("p",{class:"text-xs text-theme-text-secondary uppercase tracking-wider"},"En retard",-1))]),t("p",{class:y(["text-xl font-semibold",a.stats.overdue_count>0?"text-danger":"text-success"])},o(a.stats.overdue_count),3),e[11]||(e[11]=t("p",{class:"text-xs text-theme-text-muted"},"échéance(s)",-1))])]),g.value.length>0?(n(),d("div",dt,[e[13]||(e[13]=t("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"Je dois",-1)),t("div",at,[(n(!0),d(_,null,C(g.value,s=>(n(),d("div",{key:s.id,class:"p-4"},[t("div",it,[t("div",null,[t("p",lt,o(s.name),1),t("p",ct,o(s.contact_name||"Pas de contact"),1)]),t("div",mt,[t("button",{onClick:l=>D(s),class:"px-2 py-1 text-xs bg-theme-surface border border-theme-border rounded hover:border-theme-text-secondary transition-colors"}," Payer ",8,ut),c(i(v),{href:`/debts/${s.id}/edit`,class:"text-xs text-theme-text-secondary hover:text-theme-text-primary"},{default:b(()=>[...e[12]||(e[12]=[f("Modifier",-1)])]),_:1},8,["href"]),t("button",{onClick:l=>w(s),class:"text-xs text-theme-text-secondary hover:text-danger"},"Supprimer",8,xt)])]),p.value===s.id?(n(),d("div",ht,[F(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>i(u).amount=l),type:"number",min:"1",placeholder:"Montant",class:"flex-1 bg-theme-surface border border-theme-border rounded-md px-3 py-1.5 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[S,i(u).amount,void 0,{number:!0}]]),t("button",{onClick:l=>A(s),disabled:i(u).processing||!i(u).amount,class:"px-3 py-1.5 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 disabled:opacity-50"},"Payer",8,pt),t("button",{onClick:e[1]||(e[1]=l=>p.value=null),class:"px-3 py-1.5 text-sm text-theme-text-secondary hover:text-theme-text-primary border border-theme-border rounded-md"},"Annuler")])):x("",!0),t("div",bt,[t("span",yt,o(m(s.initial_amount-s.current_amount))+" payé / "+o(m(s.initial_amount)),1),t("span",vt,"Reste "+o(m(s.current_amount)),1)]),t("div",ft,[t("div",{class:"h-full bg-danger rounded-full",style:B({width:`${P(s)}%`})},null,4)]),s.due_date?(n(),d("p",_t,"Échéance : "+o(M(s.due_date)),1)):x("",!0)]))),128))])])):x("",!0),k.value.length>0?(n(),d("div",gt,[e[15]||(e[15]=t("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"On me doit",-1)),t("div",kt,[(n(!0),d(_,null,C(k.value,s=>(n(),d("div",{key:s.id,class:"p-4"},[t("div",wt,[t("div",null,[t("p",Ct,o(s.name),1),t("p",$t,o(s.contact_name||"Pas de contact"),1)]),t("div",Mt,[t("button",{onClick:l=>D(s),class:"px-2 py-1 text-xs bg-theme-surface border border-theme-border rounded hover:border-theme-text-secondary transition-colors"}," Reçu ",8,jt),c(i(v),{href:`/debts/${s.id}/edit`,class:"text-xs text-theme-text-secondary hover:text-theme-text-primary"},{default:b(()=>[...e[14]||(e[14]=[f("Modifier",-1)])]),_:1},8,["href"]),t("button",{onClick:l=>w(s),class:"text-xs text-theme-text-secondary hover:text-danger"},"Supprimer",8,Dt)])]),p.value===s.id?(n(),d("div",At,[F(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>i(u).amount=l),type:"number",min:"1",placeholder:"Montant reçu",class:"flex-1 bg-theme-surface border border-theme-border rounded-md px-3 py-1.5 text-sm text-theme-text-primary focus:border-theme-text-primary focus:ring-0 outline-none"},null,512),[[S,i(u).amount,void 0,{number:!0}]]),t("button",{onClick:l=>A(s),disabled:i(u).processing||!i(u).amount,class:"px-3 py-1.5 bg-theme-btn-primary-bg text-theme-btn-primary-text text-sm font-medium rounded-md hover:opacity-90 disabled:opacity-50"},"Enregistrer",8,Pt),t("button",{onClick:e[3]||(e[3]=l=>p.value=null),class:"px-3 py-1.5 text-sm text-theme-text-secondary hover:text-theme-text-primary border border-theme-border rounded-md"},"Annuler")])):x("",!0),t("div",Ft,[t("span",St,o(m(s.initial_amount-s.current_amount))+" reçu / "+o(m(s.initial_amount)),1),t("span",Bt,"Reste "+o(m(s.current_amount)),1)]),t("div",Nt,[t("div",{class:"h-full bg-success rounded-full",style:B({width:`${P(s)}%`})},null,4)]),s.due_date?(n(),d("p",Vt,"Échéance : "+o(M(s.due_date)),1)):x("",!0)]))),128))])])):x("",!0),g.value.length===0&&k.value.length===0?(n(),d("div",Zt,[e[17]||(e[17]=t("p",{class:"text-sm text-theme-text-secondary mb-4"},"Aucune dette ou créance active",-1)),c(i(v),{href:"/debts/create",class:"text-sm text-theme-text-primary hover:underline"},{default:b(()=>[...e[16]||(e[16]=[f("Ajouter une entrée",-1)])]),_:1})])):x("",!0),j.value.length>0?(n(),d("div",Rt,[e[19]||(e[19]=t("h2",{class:"text-xs font-medium text-theme-text-secondary uppercase tracking-wider mb-3"},"Historique (Payé)",-1)),t("div",Et,[t("table",Lt,[e[18]||(e[18]=t("thead",null,[t("tr",{class:"border-b border-theme-border"},[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Nom"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Type"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Montant"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-theme-text-secondary uppercase tracking-wider"},"Actions")])],-1)),t("tbody",It,[(n(!0),d(_,null,C(j.value,s=>(n(),d("tr",{key:s.id},[t("td",Ot,o(s.name),1),t("td",{class:y(["px-4 py-3 text-sm",s.type==="debt"?"text-danger":"text-success"])},o(s.type==="debt"?"Dette":"Créance"),3),t("td",Tt,o(m(s.initial_amount)),1),t("td",zt,[t("button",{onClick:l=>w(s),class:"text-xs text-theme-text-secondary hover:text-danger"},"Supprimer",8,Ht)])]))),128))])])])])):x("",!0)])]),_:1})],64))}};export{qt as default};
